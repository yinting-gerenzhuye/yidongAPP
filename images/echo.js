/*! echo.js v1.7.0 | (c) 2015 @toddmotto | https://github.com/toddmotto/echo */(function(e,t){typeof define=="function"&&define.amd?define(function(){return t(e)}):typeof exports=="object"?module.exports=t:e.echo=t(e)})(this,function(e){"use strict";var t={},n=function(){},r=window.devicePixelRatio>1,i=r?2:1,s=function(e,t,n,r,s){var o=r||100;s==undefined&&(s=!0);var u=i;return s=="false"&&(u=1),t||n?e.replace(/\.qhimg\.com\//,".qhimg.com/dr/"+u*t+"_"+u*n+"_"+o+"/"):e},o,u,a,f,l,c=function(e){return e.offsetParent===null},h=function(e,t){if(c(e))return!1;var n=e.getBoundingClientRect();return n.right>=t.l&&n.bottom>=t.t&&n.left<=t.r&&n.top<=t.b},p=function(){if(!f&&!!u)return;clearTimeout(u),u=setTimeout(function(){t.render(),u=null},a)};return t.init=function(r){r=r||{};var i=r.offset||0,u=r.offsetVertical||i,c=r.offsetHorizontal||i,h=function(e,t){return parseInt(e||t,10)};o={t:h(r.offsetTop,u),b:h(r.offsetBottom,u),l:h(r.offsetLeft,c),r:h(r.offsetRight,c)},a=h(r.throttle,250),f=r.debounce!==!1,l=!!r.unload,n=r.callback||n,s=r.imgfilter||s,t.render(),document.addEventListener?(e.addEventListener("scroll",p,!1),e.addEventListener("load",p,!1)):(e.attachEvent("onscroll",p),e.attachEvent("onload",p))},t.render=function(){var r=document.querySelectorAll("img[data-echo], [data-echo-background]"),i=r.length,u,a,f={l:0-o.l,t:0-o.t,b:(e.innerHeight||document.documentElement.clientHeight)+o.b,r:(e.innerWidth||document.documentElement.clientWidth)+o.r};for(var c=0;c<i;c++){a=r[c];if(h(a,f)){l&&a.setAttribute("data-echo-placeholder",a.src);if(a.getAttribute("data-echo-background")!==null){var p=s(a.getAttribute("data-echo-background"),a.offsetWidth,a.offsetHeight,a.getAttribute("data-echo-quality"),a.getAttribute("data-echo-retina"));a.style.backgroundImage="url("+p+")"}else{var d=s(a.getAttribute("data-echo"),a.offsetWidth,0,a.getAttribute("data-echo-quality"),a.getAttribute("data-echo-retina"));a.src=d}l||(a.removeAttribute("data-echo"),a.removeAttribute("data-echo-background")),n(a,"load")}else l&&!!(u=a.getAttribute("data-echo-placeholder"))&&(u=s(u,a.offsetWidth,a.offsetHeight,a.getAttribute("data-echo-quality"),a.getAttribute("data-echo-retina")),a.getAttribute("data-echo-background")!==null?a.style.backgroundImage="url("+u+")":a.src=u,a.removeAttribute("data-echo-placeholder"),n(a,"unload"))}i||t.detach()},t.detach=function(){document.removeEventListener?e.removeEventListener("scroll",p):e.detachEvent("onscroll",p),clearTimeout(u)},t});